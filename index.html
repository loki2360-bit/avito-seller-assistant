<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–ó–∞–∫–∞–∑-–Ω–∞—Ä—è–¥ –ø–æ —Ñ–æ—Ç–æ</title>
  <style>
    * { box-sizing: border-box; font-family: system-ui; }
    body {
      margin: 0;
      padding: 16px;
      background: #f5f7fa;
      color: #333;
    }
    .container {
      max-width: 600px;
      margin: 0 auto;
    }
    h1 {
      text-align: center;
      margin-bottom: 24px;
      color: #2c3e50;
    }
    .photo-preview {
      width: 100%;
      height: 200px;
      background: #ddd;
      border-radius: 12px;
      overflow: hidden;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
    }
    .photo-preview img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }
    .btn {
      display: block;
      width: 100%;
      padding: 14px;
      border: none;
      border-radius: 10px;
      background: #3498db;
      color: white;
      font-size: 16px;
      font-weight: bold;
      margin-bottom: 16px;
      cursor: pointer;
    }
    .btn:disabled {
      background: #bdc3c7;
      cursor: not-allowed;
    }
    .form-group {
      margin-bottom: 16px;
    }
    label {
      display: block;
      margin-bottom: 6px;
      font-weight: 600;
    }
    input {
      width: 100%;
      padding: 12px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 16px;
    }
    .orders-list {
      margin-top: 32px;
    }
    .order-item {
      background: white;
      padding: 16px;
      border-radius: 10px;
      margin-bottom: 12px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üì∏ –ù–æ–≤—ã–π –∑–∞–∫–∞–∑-–Ω–∞—Ä—è–¥</h1>

    <div class="photo-preview" id="photoPreview">
      <span>–°–¥–µ–ª–∞–π—Ç–µ —Ñ–æ—Ç–æ</span>
    </div>

    <button id="takePhotoBtn" class="btn">üì∑ –°—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—Ä–æ–≤–∞—Ç—å –∑–∞–∫–∞–∑-–Ω–∞—Ä—è–¥</button>

    <div class="form-group">
      <label for="orderNumber">–ù–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞</label>
      <input type="text" id="orderNumber" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: ‚Ññ12345">
    </div>

    <div class="form-group">
      <label for="amount">–°—É–º–º–∞ (‚ÇΩ)</label>
      <input type="number" id="amount" placeholder="15000">
    </div>

    <div class="form-group">
      <label for="customer">–ö–ª–∏–µ–Ω—Ç (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
      <input type="text" id="customer" placeholder="–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤">
    </div>

    <button id="saveOrderBtn" class="btn" style="background: #2ecc71;" disabled>
      ‚úÖ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∑–∞–∫–∞–∑
    </button>

    <div class="orders-list">
      <h2>üìã –ú–æ–∏ –∑–∞–∫–∞–∑—ã</h2>
      <div id="ordersContainer"></div>
    </div>
  </div>

  <script>
    let currentPhoto = null;
    const orders = JSON.parse(localStorage.getItem('orders')) || [];

    const takePhotoBtn = document.getElementById('takePhotoBtn');
    const saveOrderBtn = document.getElementById('saveOrderBtn');
    const photoPreview = document.getElementById('photoPreview');
    const orderNumberInput = document.getElementById('orderNumber');
    const amountInput = document.getElementById('amount');
    const customerInput = document.getElementById('customer');
    const ordersContainer = document.getElementById('ordersContainer');

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    renderOrders();

    // –°—ä—ë–º–∫–∞ —Ñ–æ—Ç–æ
    takePhotoBtn.addEventListener('click', () => {
      const input = document.createElement('input');
      input.type = 'file';
      input.accept = 'image/*';
      input.capture = 'environment'; // –æ—Ç–∫—Ä—ã—Ç—å –∫–∞–º–µ—Ä—É –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö

      input.onchange = (e) => {
        const file = e.target.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = (ev) => {
          currentPhoto = ev.target.result;
          photoPreview.innerHTML = `<img src="${currentPhoto}" alt="–§–æ—Ç–æ –∑–∞–∫–∞–∑–∞">`;
          saveOrderBtn.disabled = false;
        };
        reader.readAsDataURL(file);
      };

      input.click();
    });

    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞
    saveOrderBtn.addEventListener('click', () => {
      const number = orderNumberInput.value.trim();
      const amount = parseFloat(amountInput.value);
      const customer = customerInput.value.trim();

      if (!number || isNaN(amount)) {
        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞ –∏ —Å—É–º–º—É.');
        return;
      }

      const newOrder = {
        id: Date.now(),
        number,
        amount,
        customer: customer || '‚Äî',
        photo: currentPhoto,
        date: new Date().toISOString()
      };

      orders.unshift(newOrder);
      localStorage.setItem('orders', JSON.stringify(orders));

      // –°–±—Ä–æ—Å —Ñ–æ—Ä–º—ã
      currentPhoto = null;
      photoPreview.innerHTML = '<span>–°–¥–µ–ª–∞–π—Ç–µ —Ñ–æ—Ç–æ</span>';
      orderNumberInput.value = '';
      amountInput.value = '';
      customerInput.value = '';
      saveOrderBtn.disabled = true;

      renderOrders();
    });

    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤
    function renderOrders() {
      if (orders.length === 0) {
        ordersContainer.innerHTML = '<p style="color:#7f8c8d;">–ü–æ–∫–∞ –Ω–µ—Ç –∑–∞–∫–∞–∑–æ–≤</p>';
        return;
      }

      ordersContainer.innerHTML = orders.map(order => {
        const date = new Date(order.date);
        return `
          <div class="order-item">
            <strong>–ó–∞–∫–∞–∑ ${order.number}</strong><br>
            –ö–ª–∏–µ–Ω—Ç: ${order.customer}<br>
            –°—É–º–º–∞: ${order.amount.toLocaleString()} ‚ÇΩ<br>
            –î–∞—Ç–∞: ${date.toLocaleDateString()}
            ${order.photo ? `<br><img src="${order.photo}" style="max-width:100%; margin-top:8px; border-radius:6px;">` : ''}
          </div>
        `;
      }).join('');
    }
  </script>
</body>
</html>
